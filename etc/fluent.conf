<source>
  @type syslog
  port 24224
  tag firewall
  <parse>
    @type grok
    custom_pattern_path /fluentd/grok
    <grok>
      name iptables
      pattern %{IPTABLES}
    </grok>
    <grok>
      name fortigate
      pattern %{FORTIGATE}
    </grok>
  </parse>
</source>

<match **>
    @type copy
    <store>
      @type elasticsearch
      host elasticsearch
      port 9200
      logstash_format true
      <buffer tag>
        @type file
        path /fluentd/buffer
        flush_thread_count 8
        flush_interval 1s
        chunk_limit_size 32M
        queue_limit_length 4
        flush_mode_interval
        retry_max_interval 30
        retry_forever true
      </buffer>
    </store>
    <store>
        @type stdout
    </store>
</match>
